<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Alameri Digital | Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</title>

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        :root { --bg-dark: #0f172a; --accent: #0ea5e9; }
        html,body { height:100%; }
        body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; margin:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
        .tab { display: none; }
        .tab.active { display: block; }
        .nav-btn.active { border-bottom:3px solid var(--accent); color:var(--accent); font-weight:900; }
        /* overlay */
        .overlay { background: rgba(0,0,0,0.75); }
    </style>
</head>
<body class="antialiased">

    <!-- Ù‚ÙÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="lock-screen" class="fixed inset-0 overlay z-50 flex items-center justify-center">
        <div class="bg-slate-900 p-8 rounded-3xl w-96 text-center shadow-2xl border border-blue-600/20">
            <div class="text-5xl mb-4">ğŸ›¡ï¸</div>
            <h1 class="text-2xl font-black mb-2 text-blue-300">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</h1>
            <p class="text-sm text-slate-400 mb-6">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>

            <input id="pass-input" type="password" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ" class="w-full p-3 rounded-xl bg-slate-800 text-white mb-4 outline-none focus:ring-2 focus:ring-blue-500 text-center" />
            <button onclick="accessHQ()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-500 transition">ÙØªØ­ Ø§Ù„Ù†Ø¸Ø§Ù…</button>

            <p class="mt-4 text-xs text-slate-400">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: <span class="font-mono">123</span></p>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ -->
    <div id="app" class="hidden min-h-screen flex flex-col">

        <!-- Ø±Ø£Ø³ -->
        <header class="bg-white shadow-sm sticky top-0 z-40">
            <div class="mx-auto max-w-7xl px-6 py-4 flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <h2 class="text-2xl font-black text-blue-700">Alameri Digital</h2>
                </div>

                <div class="flex items-center gap-4">
                    <span id="wallet-balance" class="bg-blue-50 text-blue-700 px-4 py-1.5 rounded-full text-sm font-bold border border-blue-100">Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©: 0.00 Ø±.Ø³</span>
                    <button onclick="logout()" class="text-red-500 font-bold hover:underline">Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>

            <nav class="bg-gray-50 border-t">
                <div class="mx-auto max-w-7xl px-6 flex gap-6 overflow-x-auto">
                    <button onclick="showTab('overview', this)" class="nav-btn active py-3 px-4 text-sm">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</button>
                    <button onclick="showTab('products', this)" class="nav-btn py-3 px-4 text-sm">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                    <button onclick="showTab('inventory', this)" class="nav-btn py-3 px-4 text-sm">Ù…Ø®Ø²Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</button>
                    <button onclick="showTab('settings', this)" class="nav-btn py-3 px-4 text-sm">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
                </div>
            </nav>
        </header>

        <!-- Ù…Ø­ØªÙˆÙ‰ -->
        <main class="flex-1 p-6 mx-auto max-w-7xl w-full">
            <!-- Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© -->
            <section id="overview" class="tab active">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 text-center">
                    <div class="rounded-2xl p-6 bg-orange-500 text-white">
                        <p class="text-xs opacity-90">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</p>
                        <h4 id="stat-revenue" class="text-xl font-black mt-2">0.00 Ø±.Ø³</h4>
                    </div>
                    <div class="rounded-2xl p-6 bg-green-500 text-white">
                        <p class="text-xs opacity-90">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                        <h4 id="stat-orders" class="text-xl font-black mt-2">0</h4>
                    </div>
                    <div class="rounded-2xl p-6 bg-purple-500 text-white">
                        <p class="text-xs opacity-90">Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†</p>
                        <h4 id="stat-distributors" class="text-xl font-black mt-2">0</h4>
                    </div>
                    <div class="rounded-2xl p-6 bg-blue-500 text-white">
                        <p class="text-xs opacity-90">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                        <h4 id="stat-users" class="text-xl font-black mt-2">0</h4>
                    </div>
                </div>

                <div class="bg-white rounded-3xl p-12 text-center shadow-lg">
                    <div class="text-6xl mb-4 text-blue-100">ğŸ›’</div>
                    <h2 class="text-2xl font-black text-slate-800">Ø£Ù†Ø´Ø¦ Ù…ØªØ¬Ø±Ùƒ Ø§Ù„Ø¢Ù†</h2>
                    <p class="text-slate-500 mt-2 mb-6">Ø±Ø¨Ø· ÙˆÙˆØ±Ø¯Ø¨Ø±ÙŠØ³ØŒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù…Ù† Ù„ÙˆØ­Ø© ÙˆØ§Ø­Ø¯Ø©</p>
                    <button onclick="showTab('products', document.querySelectorAll('.nav-btn')[1])" class="bg-blue-600 text-white px-8 py-3 rounded-2xl font-black">+ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬Ø§Øª</button>
                </div>
            </section>

            <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
            <section id="products" class="tab">
                <div class="max-w-3xl mx-auto bg-white p-8 rounded-2xl shadow-sm border">
                    <h3 class="text-xl font-black mb-6 text-blue-700">ğŸ“¦ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h3>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                            <input id="prod-name" type="text" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ø´Ø¯Ø§Øª Ø¨Ø¨Ø¬ÙŠ 60" class="w-full p-4 bg-gray-50 rounded-2xl outline-none" />
                        </div>

                        <div>
                            <label class="block text-sm font-bold mb-2">ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬</label>
                            <textarea id="prod-desc" rows="4" placeholder="Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬..." class="w-full p-4 bg-gray-50 rounded-2xl outline-none"></textarea>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-bold mb-2">Ø§Ù„Ø³Ø¹Ø± ($)</label>
                                <input id="prod-price" type="number" class="w-full p-4 bg-gray-50 rounded-2xl text-center outline-none" />
                            </div>
                            <div>
                                <label class="block text-sm font-bold mb-2">ID ÙˆÙˆØ±Ø¯Ø¨Ø±ÙŠØ³ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
                                <input id="prod-id" type="number" class="w-full p-4 bg-gray-50 rounded-2xl text-center outline-none" />
                            </div>
                        </div>

                        <div class="flex gap-4">
                            <button onclick="saveProduct()" class="w-full bg-green-600 text-white py-3 rounded-2xl font-black">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
                            <button onclick="renderProducts()" class="w-full bg-gray-200 text-slate-800 py-3 rounded-2xl font-bold">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                        </div>
                    </div>
                </div>

                <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6" id="products-grid"></div>
            </section>

            <!-- Ù…Ø®Ø²Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª -->
            <section id="inventory" class="tab">
                <div class="max-w-3xl mx-auto bg-white p-8 rounded-2xl shadow-sm border">
                    <h3 class="text-xl font-black mb-4 text-green-600">ğŸ”‘ Ø¥Ø¶Ø§ÙØ© Ø£ÙƒÙˆØ§Ø¯ Ù„Ù„Ù…Ø®Ø²Ù†</h3>
                    <label class="block text-sm mb-2 font-bold">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†ØªØ¬ (ID)</label>
                    <input id="inv-prod-id" type="number" class="w-full p-3 bg-gray-50 rounded-2xl mb-4 outline-none" placeholder="Ù…Ø«Ù„Ø§Ù‹: 101" />

                    <label class="block text-sm mb-2 font-bold">Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ (ÙƒÙ„ ÙƒÙˆØ¯ ÙÙŠ Ø³Ø·Ø±)</label>
                    <textarea id="inv-codes" rows="6" class="w-full p-3 bg-gray-50 rounded-2xl mb-4 outline-none" placeholder="XXXX-XXXX-XXXX\nYYYY-YYYY-YYYY"></textarea>

                    <button onclick="saveCodes()" class="w-full bg-blue-600 text-white py-3 rounded-2xl font-black">Ø­ÙØ¸ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</button>
                </div>
            </section>

            <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
            <section id="settings" class="tab">
                <div class="max-w-xl mx-auto bg-white p-8 rounded-2xl shadow-sm border">
                    <h3 class="text-xl font-black mb-6 text-cyan-600">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªØ¬Ø±</h3>

                    <label class="block text-sm mb-2 font-bold">Ø§Ø³Ù… Ø§Ù„Ù…ØªØ¬Ø±</label>
                    <input id="setting-brand" type="text" class="w-full p-3 bg-gray-50 rounded-2xl mb-4 outline-none" placeholder="Ù…ØªØ¬Ø±ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ" />

                    <label class="block text-sm mb-2 font-bold">Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
                    <input id="setting-bg" type="color" value="#0f172a" class="w-16 h-10 p-1 rounded-lg mb-6" />

                    <button onclick="applySettings()" class="w-full bg-cyan-600 text-white py-3 rounded-2xl font-black">ØªØ·Ø¨ÙŠÙ‚</button>
                </div>
            </section>
        </main>

        <footer class="text-center p-6 text-xs text-slate-500">
            Â© Alameri Digital â€” Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        </footer>
    </div>

    <!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„ÙˆØ¸Ø§Ø¦Ù -->
    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© Ø¨Ø³ÙŠØ·Ø© Ù„Ù„Ø¹Ø±Ø¶ (ÙŠÙ…ÙƒÙ† Ø±Ø¨Ø· Firebase Ø£Ùˆ API Ù„Ø§Ø­Ù‚Ø§Ù‹)
        const PRODUCTS_KEY = 'weptest_products_v1';
        const CODES_KEY = 'weptest_codes_v1';

        let products = JSON.parse(localStorage.getItem(PRODUCTS_KEY) || '[]');

        function accessHQ() {
            const pass = document.getElementById('pass-input').value;
            if (pass === '123') {
                sessionStorage.setItem('isAdmin', 'true');
                document.getElementById('lock-screen').classList.add('hidden');
                document.getElementById('app').classList.remove('hidden');
                renderProducts();
            } else {
                alert('Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­!');
            }
        }

        function logout() {
            sessionStorage.clear();
            location.reload();
        }

        if (sessionStorage.getItem('isAdmin') === 'true') {
            document.getElementById('lock-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            renderProducts();
        }

        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function showTab(tabId, btnEl) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            const target = document.getElementById(tabId);
            if (target) target.classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if (btnEl && btnEl.classList) btnEl.classList.add('active');

            // scroll top for better UX
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Ø­ÙØ¸ Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯
        function saveProduct() {
            const name = document.getElementById('prod-name').value.trim();
            const desc = document.getElementById('prod-desc').value.trim();
            const price = parseFloat(document.getElementById('prod-price').value) || 0;
            const wpId = document.getElementById('prod-id').value ? Number(document.getElementById('prod-id').value) : null;

            if (!name) return alert('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬ Ø£ÙˆÙ„Ø§Ù‹');

            const p = { id: Date.now(), name, desc, price, wpId };
            products.push(p);
            localStorage.setItem(PRODUCTS_KEY, JSON.stringify(products));
            alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
            clearProductForm();
            renderProducts();
            showTab('products', document.querySelectorAll('.nav-btn')[1]);
        }

        function clearProductForm() {
            document.getElementById('prod-name').value = '';
            document.getElementById('prod-desc').value = '';
            document.getElementById('prod-price').value = '';
            document.getElementById('prod-id').value = '';
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        function renderProducts() {
            const grid = document.getElementById('products-grid');
            if (!grid) return;
            if (products.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center text-slate-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¹Ø¯</div>';
                return;
            }

            grid.innerHTML = products.map(p => `
                <div class="bg-white p-6 rounded-2xl shadow hover:shadow-lg transition">
                    <div class="h-40 bg-gray-50 rounded-2xl flex items-center justify-center mb-4">
                        <img src="https://via.placeholder.com/220x120?text=Product" alt="${escapeHtml(p.name)}" class="object-contain h-full" />
                    </div>
                    <h4 class="font-black text-lg mb-2">${escapeHtml(p.name)}</h4>
                    <p class="text-sm text-slate-500 mb-4">${escapeHtml(p.desc || '')}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-2xl font-black text-blue-600">${p.price} $</span>
                        <div class="flex gap-2">
                            <button onclick="sellProduct(${p.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg">Ø´Ø±Ø§Ø¡</button>
                            <button onclick="deleteProduct(${p.id})" class="bg-red-100 text-red-600 px-3 py-2 rounded-lg">Ø­Ø°Ù</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function sellProduct(id) {
            alert('Ù…Ø­Ø§ÙƒØ§Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¯ÙØ¹ â€” Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø±Ø¨Ø· ÙˆÙˆØ±Ø¯Ø¨Ø±ÙŠØ³/Ø¨ÙˆØ§Ø¨Ø© Ø¯ÙØ¹');
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ù„Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            document.getElementById('stat-orders').innerText = Number(document.getElementById('stat-orders').innerText || 0) + 1;
        }

        function deleteProduct(id) {
            if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) return;
            products = products.filter(p => p.id !== id);
            localStorage.setItem(PRODUCTS_KEY, JSON.stringify(products));
            renderProducts();
        }

        // Ø­ÙØ¸ Ø£ÙƒÙˆØ§Ø¯ ÙÙŠ Ø§Ù„Ù…Ø®Ø²Ù†
        function saveCodes() {
            const prodId = Number(document.getElementById('inv-prod-id').value);
            const codesText = document.getElementById('inv-codes').value.trim();
            if (!prodId || !codesText) return alert('Ø£Ø¯Ø®Ù„ ID Ø§Ù„Ù…Ù†ØªØ¬ ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¯');

            const codes = codesText.split(/\r?\n/).map(s => s.trim()).filter(Boolean);
            const store = JSON.parse(localStorage.getItem(CODES_KEY) || '{}');
            store[prodId] = (store[prodId] || []).concat(codes);
            localStorage.setItem(CODES_KEY, JSON.stringify(store));
            alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ù„Ù„Ù…Ø®Ø²ÙˆÙ† Ø¨Ù†Ø¬Ø§Ø­');
            document.getElementById('inv-prod-id').value = '';
            document.getElementById('inv-codes').value = '';
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function applySettings() {
            const brand = document.getElementById('setting-brand').value.trim();
            const bg = document.getElementById('setting-bg').value;
            if (brand) document.querySelector('header h2').innerText = brand;
            if (bg) document.body.style.backgroundColor = bg;
            alert('ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª');
        }

        // Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙØ§Ø¯ÙŠ XSS Ø¨Ø³ÙŠØ· Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¯Ø±Ø§Ø¬ ÙÙŠ DOM
        function escapeHtml(str) {
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }

        // render at start if admin
        if (sessionStorage.getItem('isAdmin') === 'true') {
            document.getElementById('lock-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            renderProducts();
        }
    </script>
</body>
</html>
