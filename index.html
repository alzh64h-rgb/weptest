<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alameri Digital | Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">

  <!-- EmailJS (Ø§Ø®ØªÙŠØ§Ø±ÙŠ - Ø®ÙŠØ§Ø± Ø³Ø±ÙŠØ¹ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„) -->
  <script src="https://cdn.emailjs.com/sdk/3.2/email.min.js"></script>

  <style>
    :root { --bg-dark: #0f172a; --accent: #0ea5e9; }
    html,body { height:100%; }
    body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; margin:0; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    .tab { display: none; }
    .tab.active { display: block; }
    .overlay { background: rgba(0,0,0,0.75); }
  </style>
</head>
<body class="antialiased">

  <!-- Ù‚ÙÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
  <div id="lock-screen" class="fixed inset-0 overlay z-50 flex items-center justify-center">
    <div class="bg-slate-900 p-8 rounded-3xl w-96 text-center shadow-2xl border border-blue-600/20">
      <div class="text-5xl mb-4">ğŸ›¡ï¸</div>
      <h1 class="text-2xl font-black mb-2 text-blue-300">Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</h1>
      <p class="text-sm text-slate-400 mb-6">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>

      <input id="pass-input" type="password" placeholder="Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø³Ø±ÙŠ"
        class="w-full p-3 rounded-xl bg-slate-800 text-white mb-4 outline-none focus:ring-2 focus:ring-blue-500 text-center" />

      <div class="flex gap-2 mb-4">
        <button id="open-btn" onclick="accessHQ()" class="flex-1 w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-500 transition">ÙØªØ­ Ø§Ù„Ù†Ø¸Ø§Ù…</button>
        <button id="send-verif-btn" onclick="sendVerification()" class="bg-slate-700 text-white px-4 py-3 rounded-xl font-bold hover:bg-slate-600 transition">Ø£Ø±Ø³Ù„ Ø±Ù…Ø²</button>
      </div>

      <p id="verif-feedback" class="mt-2 text-xs text-slate-400">Ù„Ø£Ù…Ø§Ù† Ø£ÙƒØ«Ø±ØŒ Ø§Ø¶ØºØ· "Ø£Ø±Ø³Ù„ Ø±Ù…Ø²" Ù„ØªÙ„Ù‚ÙŠ Ø±Ù…Ø² Ø¹Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ.</p>

      <!-- Ù…Ù„Ø§Ø­Ø¸Ø© Ø£Ù…Ù†ÙŠØ©: Ù„Ø§ ØªØ¹Ø±Ø¶ Ø£ÙŠ ÙƒÙ„Ù…Ø© Ø³Ø±/Ø±Ù…Ø² Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ù†Ø§ -->
      <!--<p class="mt-4 text-xs text-slate-400">Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ: <span class="font-mono">123</span></p>-->
    </div>
  </div>

  <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Ø¨Ù‚ÙŠÙ‘Ø© Ø§Ù„ØµÙØ­Ø© ÙƒÙ…Ø§ Ù‡ÙŠ) -->
  <div id="app" class="hidden min-h-screen flex flex-col">
    <!-- ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ ÙƒÙ…Ø§ ÙÙŠ Ù…Ø´Ø±ÙˆØ¹Ùƒ ... -->
  </div>

  <!-- Ø³ÙƒØ±Ø¨ØªØ§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ -->
  <script>
    // --- ØªÙ‡ÙŠØ¦Ø© EmailJS (Ø¥Ù† Ø§Ø®ØªØ±Øª Ø§Ù„Ø­Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹) ---
    // Ø§Ø³ØªØ¨Ø¯Ù„ 'YOUR_EMAILJS_USER_ID' Ø¨Ø§Ù„Ù€ user id Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† EmailJS
    // Ø£Ùˆ Ø§Ù†Ø´Ø¦ Ù…ÙØªØ§Ø­ Ø®Ø§Øµ Ø¨Ùƒ. (Ø¥Ù† Ù„Ù… ØªØ³ØªØ®Ø¯Ù… EmailJS Ø§Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø±)
    try { emailjs.init('YOUR_EMAILJS_USER_ID'); } catch(e){ /* ignore if not used */ }

    // Ù…ÙØªØ§Ø­/Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ­Ù‚Ù‚:
    // Ø³Ù†Ø®Ø²Ù† Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù…Ø´ÙÙ‘Ø±Ø§Ù‹ (Ø¨Ù€ btoa) ÙÙŠ sessionStorage ØªØ­Øª 'weptest_verif'
    // ÙˆÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© ØµØºÙŠØ± (Ù…Ø«Ù„Ø§Ù‹ 10 Ø¯Ù‚Ø§Ø¦Ù‚)
    function setVerification(code, ttlSeconds = 600) {
      const payload = {
        code: btoa(String(code)),
        expiresAt: Date.now() + ttlSeconds * 1000
      };
      sessionStorage.setItem('weptest_verif', JSON.stringify(payload));
    }

    function getVerification() {
      const raw = sessionStorage.getItem('weptest_verif');
      if (!raw) return null;
      try {
        const obj = JSON.parse(raw);
        if (Date.now() > obj.expiresAt) {
          sessionStorage.removeItem('weptest_verif');
          return null;
        }
        return obj;
      } catch(e) { return null; }
    }

    function clearVerification() {
      sessionStorage.removeItem('weptest_verif');
    }

    // ØªÙˆÙ„ÙŠØ¯ Ø±Ù…Ø² Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…
    function genCode() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ (Ø®ÙŠØ§Ø± Ø³Ø±ÙŠØ¹: EmailJS Ù…Ù† Ø¬Ù‡Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„)
    // ÙŠØªÙˆÙ‚Ù‘Ø¹ Ø£Ù† ØªØ³ØªØ¨Ø¯Ù„: serviceID, templateID, Ùˆ userID (Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø£Ø¹Ù„Ø§Ù‡)
    async function sendVerification() {
      const btn = document.getElementById('send-verif-btn');
      const feedback = document.getElementById('verif-feedback');

      // read saved user email Ù…Ù† localStorage Ø¥Ø°Ø§ Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø£Ùˆ Ø§Ø·Ù„Ø¨Ù‡Ø§
      let userEmail = localStorage.getItem('weptest_user_email') || '';
      if (!userEmail) {
        userEmail = prompt('Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„ØªÙ„Ù‚ÙŠ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚:');
        if (!userEmail) return;
        localStorage.setItem('weptest_user_email', userEmail);
      }

      const code = genCode();
      setVerification(code, 600); // ØµØ§Ù„Ø­ 10 Ø¯Ù‚Ø§Ø¦Ù‚

      // Ø®ÙŠØ§Ø± 1: Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± EmailJS (Ø³Ø±ÙŠØ¹ Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
      const serviceID = 'YOUR_EMAILJS_SERVICE_ID';
      const templateID = 'YOUR_EMAILJS_TEMPLATE_ID';
      const templateParams = {
        to_email: userEmail,
        verification_code: code,
        site_name: 'weptest'
      };

      btn.disabled = true;
      feedback.innerText = 'Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²...';

      // Ø¥Ø°Ø§ Ù„Ù… ØªÙÙ‡ÙŠÙ‘Ø¦ EmailJS Ø£Ùˆ Ù„Ù… ØªØ±Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø±Ù‡ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ ØµÙØ­Ø© (Ù„Ø§ ÙŠÙÙ†ØµØ­ Ø¨Ø§Ù„Ø¥Ø¨Ù‚Ø§Ø¡)
      if (typeof emailjs !== 'undefined' && serviceID !== 'YOUR_EMAILJS_SERVICE_ID') {
        try {
          await emailjs.send(serviceID, templateID, templateParams);
          feedback.innerText = 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.';
        } catch (err) {
          console.error(err);
          feedback.innerText = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± EmailJS. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ù„ Ø§Ù„Ø¢Ù…Ù†.';
        }
      } else {
        // ÙØ´Ù„/Ù„Ù… ØªÙÙ‡ÙŠÙ‘Ø¦ EmailJS: Ù†Ø¹Ø±Ø¶ ØªÙ†Ø¨ÙŠÙ‡ (Ù„Ù„ØªØ¬Ø±Ø¨Ø© ÙÙ‚Ø·)
        // ØªØ­Ø°ÙŠØ±: Ù‡Ø°Ø§ Ø³ÙŠØ¹Ø±Ø¶ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ â€” Ù„Ø§ ØªØªØ±ÙƒÙ‡ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø­Ù‚ÙŠÙ‚ÙŠØ©.
        alert('Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ (ØªØ¬Ø±ÙŠØ¨ÙŠ): ' + code + '\nÙ…Ù„Ø§Ø­Ø¸Ø©: ÙØ¹Ù‘Ù„ EmailJS Ù„Ø¥Ø±Ø³Ø§Ù„ Ø­Ù‚ÙŠÙ‚ÙŠ Ø¹Ø¨Ø± Ø§Ù„Ø¨Ø±ÙŠØ¯.');
        feedback.innerText = 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø±Ù…Ø² (ÙˆØ¸Ù‡ÙˆØ± ØªØ¬Ø±ÙŠØ¨ÙŠ). ÙØ¹Ù‘Ù„ EmailJS Ù„Ù„Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ.';
      }

      // Ù…Ù†Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ù…Ø¯Ø© 60 Ø«Ø§Ù†ÙŠØ©
      let delay = 60;
      const origText = btn.innerText;
      btn.innerText = `Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ ${delay}s`;
      const timer = setInterval(() => {
        delay--;
        if (delay <= 0) {
          clearInterval(timer);
          btn.disabled = false;
          btn.innerText = origText;
        } else {
          btn.innerText = `Ø£Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ø¹Ø¯ ${delay}s`;
        }
      }, 1000);
    }

    // ØªØ¯Ù‚ÙŠÙ‚ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±/Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· "ÙØªØ­ Ø§Ù„Ù†Ø¸Ø§Ù…"
    function accessHQ() {
      const pass = document.getElementById('pass-input').value.trim();
      if (!pass) return alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²');

      // Ø£ÙˆÙ„Ø§Ù‹: ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ ØµØ§Ù„Ø­ ÙÙŠ Ø§Ù„Ø¬Ù„Ø³Ø©
      const ver = getVerification();
      if (ver && btoa(pass) === ver.code) {
        sessionStorage.setItem('isAdmin', 'true');
        clearVerification();
        document.getElementById('lock-screen').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        if (typeof renderProducts === 'function') renderProducts();
        return;
      }

      // Ø¨Ø¯ÙŠÙ„: Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø¥Ø¹Ø¯Ø§Ø¯ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¥Ø¯Ø§Ø±ÙŠØ© ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Ù…Ø®Ø²Ù†Ø© ÙÙŠ localStorage hashed)
      const adminHash = localStorage.getItem('weptest_admin_hash'); // Ù…Ø«Ø§Ù„: btoa('yourpass')
      if (adminHash && btoa(pass) === adminHash) {
        sessionStorage.setItem('isAdmin', 'true');
        document.getElementById('lock-screen').classList.add('hidden');
        document.getElementById('app').classList.remove('hidden');
        if (typeof renderProducts === 'function') renderProducts();
        return;
      }

      alert('Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­!');
    }

    function logout() {
      sessionStorage.clear();
      location.reload();
    }

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©: Ø§Ø°Ø§ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø³Ø§Ø¨Ù‚Ù‹Ø§
    if (sessionStorage.getItem('isAdmin') === 'true') {
      document.getElementById('lock-screen').classList.add('hidden');
      document.getElementById('app').classList.remove('hidden');
      if (typeof renderProducts === 'function') renderProducts();
    }
  </script>
</body>
</html>
